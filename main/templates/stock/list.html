{% extends "master.html" %}
{% load static %}

    <!-- TITULO -->
    {% block titulo %}<span class="border-bottom border-warning border-5">Gesti&oacute;n de stock</span>{% endblock %}

    {% block contenido %} 

    <!-- REST OF THE PAGE -->

        <!-- FILTERS -->
        <div class="row h-100 mb-4">
            <div class="col-12">
                <div id="id-menuDiv" class="row justify-content-between">
                    <div class="col-md-1 col-4 mb-md-0 mb-3 d-flex">
                        <div class="btn-group m-auto w-100 " role="group" aria-label="showStock">
                            <button class="btn btn-outline-dark" onclick="toGrid()"><i class="bi bi-grid"></i></button>
                            <button class="btn btn-outline-dark" onclick="toList()"><i class="bi bi-list-ul"></i></button>
                        </div>
                    </div>
                    <div class="col-md-6 col-8 mb-md-0 mb-3">
                        <div class="input-group rounded border-dark w-100">
                            <div class="form-floating">
                                <input type="search" id="id-searchStock" class="form-control" placeholder="Escribe un producto...">
                                <label for="id-searchStock"><i class="bi bi-search"></i>&nbsp;Escribe un producto...</label>
                            </div>
                            <button class="btn btn-dark">Filtrar</button>
                        </div>
                    </div>
                    <div class="col-md-3 col-12 mb-md-0 mb-3 d-flex">
                        <a href="register" class="m-auto w-100 btn btn-warning border-dark"><i class="bi bi-plus-lg"></i>A&ntilde;adir stock</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- CARDS -->
        <div class="row h-100 mb-4">
            <div class="col-12">
                <div id="id-cardsDiv" class="row row-cols-1 row-cols-md-3 g-4">

                    {% for product in stock %}
                    <div id="id-productDiv-{{forloop.counter}}" class="productDiv">
                        <div class="card card-stock">
                            <div class="row g-0">
                                <div class="card-img-col col-12">
                                    <img src="{% static product.picture %}" class="card-img-top" alt="{{product.name}}">
                                </div>
                                <div class="card-body-col col-12">
                                    <div class="card-body">
                                        <h5 class="card-title"><span title="{{product.name}}">{{product.name}}</span></h5>
                                        <p class="card-text">{{product.amount}} unidad{% if product.amount != 1 %}es{% endif %}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}

                </div>
            </div>
        </div>
        
        <script>
            function toList(){
                let rowdiv = document.getElementById('id-cardsDiv');
                rowdiv.classList.remove('row-cols-md-3');

                let elements = document.getElementsByClassName('card-stock');
                Array.from(elements).forEach(element => {
                    element.classList.add('card-stock-list');
                    element.classList.remove('card-stock');
                    let elImgCol = element.querySelector('.card-img-col')
                    elImgCol.classList.add('col-4', 'col-md-3');
                    elImgCol.classList.remove('col-12');
                    let elBodyCol = element.querySelector('.card-body-col')
                    elBodyCol.classList.add('col-8','col-md-9');
                    elBodyCol.classList.remove('col-12');
                });
            }

            function toGrid(){
                let rowdiv = document.getElementById('id-cardsDiv');
                rowdiv.classList.add('row-cols-md-3');

                let elements = document.getElementsByClassName('card-stock-list');
                Array.from(elements).forEach(element => {
                    element.classList.add('card-stock');
                    element.classList.remove('card-stock-list');
                    let elImgCol = element.querySelector('.card-img-col')
                    elImgCol.classList.add('col-12');
                    elImgCol.classList.remove('col-4', 'col-md-3');
                    let elBodyCol = element.querySelector('.card-body-col')
                    elBodyCol.classList.add('col-12');
                    elBodyCol.classList.remove('col-8','col-md-9');
                });
            }
    </script>
    {% endblock %}